### ğŸ“… Streak Statistics
<!-- Commit Streak Statistics -->
<img alt="Commit Streak" align="left" width="400px" src="https://github-readme-streak-stats.herokuapp.com/?user=xiaoran67&theme=dark&fire=FF4500&hide_border=true">
<br clear="both">

### ğŸ“Š Core Code Stats
<!-- Core Code Statistics (Commits/Stars) -->
<img alt="Code Stats (Commits/Stars)" align="left" width="400px" src="https://github-readme-stats.vercel.app/api?username=xiaoran67&show_icons=true&count_private=true&theme=dark&hide_border=true">
<br clear="both">

### ğŸ—‚ï¸ Most Used Languages (Compact)
<!-- Most Used Languages (Compact List) -->
<img alt="Languages Share (Compact)" align="left" width="400px" src="https://github-readme-stats.vercel.app/api/top-langs/?username=xiaoran67&layout=compact&theme=dark&hide_border=true">
<br clear="both">

### ğŸ© Most Used Languages (Donut Chart)
<!-- Most Used Languages (Donut Chart) -->
<img alt="Languages Share (Donut)" align="left" width="400px" src="https://github-readme-stats.vercel.app/api/top-langs/?username=xiaoran67&layout=donut&theme=dark&hide_border=true&include_all_commits=true">
<br clear="both">

### ğŸ”¥ Annual Contribution Heatmap

<!-- Annual Contribution Heatmap -->
<img alt="Annual Contribution Heatmap" align="left" width="800px" src="https://github-readme-stats.vercel.app/api?username=xiaoran67&show_icons=false&count_private=true&theme=dark&hide_border=true&custom_title=å¹´åº¦è´¡çŒ®çƒ­åŠ›å›¾&card_width=800&include_all_commits=true">
<br clear="both">

### ğŸ† Open Source Contribution Level Badge
<!-- Open Source Contribution Level Badge -->
<img alt="Contribution Level" align="left" width="400px" src="https://github-profile-trophy.vercel.app/?username=xiaoran67&theme=darkhub&no-frame=true&no-bg=true&margin-w=4">
<br clear="both">

### ğŸ‘ï¸ Homepage Total Views
<!-- Homepage Total Views -->
![Homepage Total Views](https://count.getloli.com/get/@xiaoran67?theme=asoul)
<br clear="both">

### ğŸ“Š Star History
[![Star History](https://starchart.cc/xiaoran67/update.svg?variant=adaptive)](https://starchart.cc/xiaoran67/update)

### â­ Star History Chart
[![Star History Chart](https://api.star-history.com/svg?repos=xiaoran67/update&type=Date)](https://star-history.com/#xiaoran67/update&Date)

### ğŸ“ License
[MIT](./LICENSE) License &copy; 2023-PRESENT [xiaoran67](https://github.com/xiaoran67)

### âš ï¸ Disclaimer
This project is for educational and communication purposes only. All interface data is sourced from the internet; we do not provide any playlists or other digital content, and please contact us for removal if there is any infringement.

### ğŸ’¬ Connect With Me
<div align="center">
  <a href="https://t.me/xiaoran37" target="_blank">
    <img src="https://img.shields.io/badge/Telegram-2CA5E0?style=for-the-badge&logo=telegram&logoColor=white" alt="Telegram">
  </a>
  <a href="mailto:xiaoranmuze@gmail.com" target="_blank">
    <img src="https://img.shields.io/badge/Gmail-D14836?style=for-the-badge&logo=gmail&logoColor=white" alt="Gmail">
  </a>
  <a href="https://github.com/xiaoran67" target="_blank">
    <img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white" alt="GitHub">
  </a>
</div>

<div align="center">
<div class="contact-info">
    <a href="https://t.me/xiaoran37" target="_blank">
        <img src="https://img.shields.io/badge/Telegram-@xiaoran37-blue?style=flat-square&logo=telegram" alt="Telegram" />
    </a>
</div>

### ğŸ“ˆ Project Metrics
<div align="center">
<br>

[![GitHub Stars](https://img.shields.io/github/stars/xiaoran67/update?style=social)](https://github.com/xiaoran67/update/stargazers)
[![GitHub Forks](https://img.shields.io/github/forks/xiaoran67/update?style=social)](https://github.com/xiaoran67/update/network/members)
[![Latest Release](https://img.shields.io/github/v/release/xiaoran67/update)](https://github.com/xiaoran67/update/releases/latest)
[![Total Downloads](https://img.shields.io/github/downloads/xiaoran67/update/total)](https://github.com/xiaoran67/update/releases/latest)
[![GitHub Issues](https://img.shields.io/github/issues/xiaoran67/update)](https://github.com/xiaoran67/update/issues)
[![GitHub Pull Requests](https://img.shields.io/github/issues-pr/xiaoran67/update)](https://github.com/xiaoran67/update/pulls)
[![License](https://img.shields.io/github/license/xiaoran67/update)](https://github.com/xiaoran67/update/blob/main/LICENSE)
[![Python Version](https://img.shields.io/badge/python-%3D%203.13-47c219)](https://www.python.org/)
[![Docker Pulls](https://img.shields.io/docker/pulls/xiaoran67/update)](https://hub.docker.com/repository/docker/xiaoran67/update)

<br>

[![GitHub Stars](https://img.shields.io/github/stars/xiaoran67/update)](https://github.com/xiaoran67/update)
[![GitHub Forks](https://img.shields.io/github/forks/xiaoran67/update)](https://github.com/xiaoran67/update/fork)
[![Latest Release](https://img.shields.io/github/v/release/xiaoran67/update)](https://github.com/xiaoran67/update/releases)
[![Total Downloads](https://img.shields.io/github/downloads/xiaoran67/update/total)](https://github.com/xiaoran67/update/releases)
[![GitHub Issues](https://img.shields.io/github/issues/xiaoran67/update)](https://github.com/xiaoran67/update/issues)
[![GitHub Pull Requests](https://img.shields.io/github/issues-pr/xiaoran67/update)](https://github.com/xiaoran67/update/pulls)
[![License](https://img.shields.io/github/license/xiaoran67/update)](https://github.com/xiaoran67/update/blob/main/LICENSE)
[![Python Version](https://img.shields.io/badge/python-%3D%203.13-47c219)](https://www.python.org/)
[![Docker Pulls](https://img.shields.io/docker/pulls/xiaoran67/update)](https://hub.docker.com/repository/docker/xiaoran67/update)

# ğŸ“º è‡ªåŠ¨æŠ“å–æºè„šæœ¬

å…¨æµç¨‹è‡ªåŠ¨åŒ–çš„å¹¿ä¸œç§»åŠ¨IPTVé¢‘é“åˆ—è¡¨å’ŒEPGèŠ‚ç›®å•æŠ“å–å·¥å…·ï¼Œæ”¯æŒé¢‘é“åˆ†ç»„ã€é»‘åå•è¿‡æ»¤ã€è‡ªå®šä¹‰é¢‘é“åˆå¹¶ã€åˆ†ç»„æ’åºã€å›çœ‹åŠŸèƒ½ç­‰ã€‚

**ç‰ˆæœ¬æ—¥æœŸ**: 2025.11.20

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- **ğŸ“¥ è‡ªåŠ¨ä¸‹è½½é¢‘é“åˆ—è¡¨**ï¼šä»å¹¿ä¸œç§»åŠ¨IPTVæœåŠ¡å™¨è‡ªåŠ¨è·å–é¢‘é“JSONæ•°æ®ï¼ˆè¦æ±‚èƒ½è®¿é—®183.235.0.0/16ç½‘æ®µï¼‰
- **ğŸ—‚ï¸ æ™ºèƒ½é¢‘é“åˆ†ç»„**ï¼šè‡ªåŠ¨å°†é¢‘é“åˆ†ç±»ä¸ºå¤®è§†ã€å¤®è§†ç‰¹è‰²ã€å¹¿ä¸œã€å«è§†ã€å°‘å„¿ã€CGTNã€åæ•°å’ªå’•ã€è¶…æ¸…4kã€å¹¿ä¸œåœ°æ–¹å°ã€å…¶ä»–ç­‰åˆ†ç»„
- **ğŸ”„ é¢‘é“å»é‡**ï¼šè‡ªåŠ¨å»é™¤é‡å¤é¢‘é“ï¼Œå¤šæ¸…æ™°åº¦çš„å‰”é™¤äº†æ ‡æ¸…é¢‘é“ï¼Œåªä¿ç•™é«˜æ¸…/è¶…æ¸…/4kç‰ˆæœ¬
- **ğŸš« é»‘åå•è¿‡æ»¤**ï¼šæ”¯æŒæŒ‰æ ‡é¢˜å…³é”®è¯ã€é¢‘é“ä»£ç (code)æˆ–æ’­æ”¾é“¾æ¥(zteurl)è¿‡æ»¤é¢‘é“
- **â• è‡ªå®šä¹‰é¢‘é“åˆå¹¶**ï¼šé€šè¿‡ `custom_channels.json` æ·»åŠ è‡ªå®šä¹‰é¢‘é“
- **ğŸ”— å¤–éƒ¨ M3U åˆå¹¶**ï¼šæ”¯æŒä»å¤–éƒ¨ M3U æºä¸‹è½½å¹¶åˆå¹¶æŒ‡å®šåˆ†ç»„çš„é¢‘é“ï¼ˆå¦‚ç²¤è¯­é¢‘é“ã€ä½“è‚²é¢‘é“ç­‰ï¼‰ï¼Œè‡ªåŠ¨åº”ç”¨é»‘åå•è¿‡æ»¤å’Œ Nginx ä»£ç†
- **ğŸ“Š åˆ†ç»„æ’åº**ï¼šé€šè¿‡ `channel_order.json` è‡ªå®šä¹‰å„åˆ†ç»„å†…é¢‘é“çš„æ’åº
- **ğŸ·ï¸ é¢‘é“åç§°æ˜ å°„**ï¼šæ”¯æŒé¢‘é“åç§°æ˜ å°„ï¼ˆå¦‚ "CCTV-3é«˜æ¸…" â†’ "CCTV-3ç»¼è‰º"ï¼‰ï¼Œåªä¿®æ”¹æœ€ååå­—ï¼Œtvg-id tvg-name é€‚é…ä¸å½±å“EPGå¯¹é½

### ğŸ“‹ M3Uæ–‡ä»¶ç”Ÿæˆ

è„šæœ¬ä¼šç”Ÿæˆ3ä¸ªM3Uæ–‡ä»¶ï¼š

1. **tv.m3u**ï¼šç»„æ’­åœ°å€åˆ—è¡¨ï¼ˆåŸå§‹ç»„æ’­åœ°å€ï¼‰
2. **tv2.m3u**ï¼šå•æ’­åœ°å€åˆ—è¡¨ï¼ˆé€šè¿‡msd_liteè½¬æ¢çš„ç»„æ’­åœ°å€ï¼Œé»˜è®¤å›çœ‹å‚æ•°æ”¯æŒokå½±è§†,mytv-android[ç”µè§†ç›´æ’­]ï¼‰
3. **ku9.m3u**ï¼šå•æ’­åœ°å€åˆ—è¡¨ï¼ˆå›çœ‹å‚æ•°æ ¼å¼åªæ”¯æŒ é…·9 1.76+ï¼‰

### ğŸ“º EPGèŠ‚ç›®å•

- **â¬‡ï¸ è‡ªåŠ¨ä¸‹è½½EPG**ï¼šæ ¹æ®é¢‘é“codeè‡ªåŠ¨ä¸‹è½½EPGæ•°æ®
- **ğŸŒ æ”¯æŒå¤šæºä¸‹è½½**ï¼šå¯é…ç½®å¤šä¸ªEPGä¸‹è½½æºï¼Œè‡ªåŠ¨åˆ†é…ä»»åŠ¡
- **âš™ï¸ ä¸‹è½½æ¨¡å¼**ï¼š
  - `M3U_ONLY`ï¼šä»…ä¸‹è½½M3Uæ–‡ä»¶ä¸­åŒ…å«çš„é¢‘é“EPGï¼ˆæ¨èï¼‰
  - `ALL`ï¼šä¸‹è½½æ‰€æœ‰å¯ç”¨é¢‘é“çš„EPGï¼ˆåŒ…æ‹¬è¢«è¿‡æ»¤çš„é¢‘é“ï¼‰
- **ğŸ“¦ ç”Ÿæˆæ–‡ä»¶**ï¼š
  - `t.xml`ï¼šXMLæ ¼å¼çš„EPGèŠ‚ç›®å•
  - `t.xml.gz`ï¼šå‹ç¼©åçš„EPGæ–‡ä»¶
  - `epg_statistics.log`ï¼šEPGä¸‹è½½ç»Ÿè®¡æ—¥å¿—

### âª å›çœ‹åŠŸèƒ½

- **ğŸ” è‡ªåŠ¨è¯†åˆ«**ï¼šæ ¹æ®JSONä¸­çš„ `timeshiftAvailable` æˆ– `lookbackAvailable` å­—æ®µè‡ªåŠ¨æ·»åŠ å›çœ‹å‚æ•°
- **ğŸ“ åŒæ¨¡æ¿æ”¯æŒ**ï¼š
  - æ ‡å‡†å›çœ‹æ¨¡æ¿ï¼šé€‚é…OKå½±è§†_3.16,,mytv-android_V2.0.0.191[ç”µè§†ç›´æ’­]ç­‰æ’­æ”¾å™¨
  - KU9å›çœ‹æ¨¡æ¿ï¼šé€‚é…é…·9 1.76+
- **ğŸŒ Nginxä»£ç†æ”¯æŒ**ï¼šæ”¯æŒé€šè¿‡Nginxä»£ç†å›çœ‹æºï¼Œå®ç°å¤–ç½‘è®¿é—®

### ğŸ“ æ—¥å¿—æ–‡ä»¶

- **channel_processing.log**ï¼šé¢‘é“å¤„ç†æ—¥å¿—ï¼Œè®°å½•å»é‡ã€æ”¹åã€é»‘åå•è¿‡æ»¤ç­‰æ“ä½œ
- **epg_statistics.log**ï¼šEPGä¸‹è½½å’Œåˆæˆç»Ÿè®¡ä¿¡æ¯

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºæœ¬é…ç½®

åœ¨ `tv.py` æ–‡ä»¶é¡¶éƒ¨ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

```python
# UDPXYåœ°å€ï¼ˆç»„æ’­è½¬å•æ’­ï¼‰
REPLACEMENT_IP = "http://c.top:7088/udp"

# âª å›çœ‹æºå‰ç¼€ï¼Œæš‚æ—¶æ˜¯ä¸­å…´å¹³å°çš„å›çœ‹æ ¼å¼ï¼Œç§»åŠ¨éƒ½é€‚ç”¨ï¼Œåä¸ºçš„å›çœ‹é¢‘é“å‚æ•°å¹¶æ²¡æœ‰å®ç°ï¼Œä½†æ˜¯åä¸ºç›’å­çš„ä¹Ÿèƒ½ç”¨ä¸­å…´æ ¼å¼çš„
CATCHUP_SOURCE_PREFIX = "http://183.235.162.80:6610/190000002005"

# ğŸŒ Nginxä»£ç†å‰ç¼€ï¼ˆç”¨äºå¤–ç½‘è®¿é—®ï¼‰é»˜è®¤ä¸ºç©º ""ï¼Œåªåœ¨å±€åŸŸç½‘ç”Ÿæ•ˆ
NGINX_PROXY_PREFIX = "http://c.top:7077"

# JSONæ•°æ®æºåœ°å€
JSON_URL = "http://183.235.16.92:8082/epg/api/custom/getAllChannel.json"

# ğŸ“º EPGä¸‹è½½æºï¼ˆé»˜è®¤ä¸ºä¸¤ä¸ªåœ°å€ï¼Œå¯ä»¥åˆ é™¤ä¸€ä¸ªï¼‰
EPG_BASE_URLS = [
    "http://183.235.16.92:8082/epg/api/channel/",
    "http://183.235.11.39:8082/epg/api/channel/"
]
```

### âª å›çœ‹æ¨¡æ¿é…ç½®

```python
# æ ‡å‡†å›çœ‹æ¨¡æ¿ï¼ˆOKå½±è§†ç­‰ï¼‰
CATCHUP_URL_TEMPLATE = "{prefix}/{ztecode}/index.m3u8?starttime=${{utc:yyyyMMddHHmmss}}&endtime=${{utcend:yyyyMMddHHmmss}}"

# KU9å›çœ‹æ¨¡æ¿ï¼ˆé…·9æœ€æ–°ç‰ˆï¼‰
CATCHUP_URL_KU9 = "{prefix}/{ztecode}/index.m3u8?starttime=${{(b)yyyyMMddHHmmss|UTC}}&endtime=${{(e)yyyyMMddHHmmss|UTC}}"
```

### ğŸ“º EPGé…ç½®

```python
# EPGä¸‹è½½å¼€å…³
ENABLE_EPG_DOWNLOAD = True  # True-å¯ç”¨, False-ç¦ç”¨

# EPGä¸‹è½½æ¨¡å¼
EPG_DOWNLOAD_MODE = "M3U_ONLY"  # "M3U_ONLY" æˆ– "ALL"

# EPGåˆæˆæ¨¡å¼
XML_SKIP_CHANNELS_WITHOUT_EPG = True  # True-è·³è¿‡æ— EPGçš„é¢‘é“, False-ä¿ç•™é¢‘é“æ ‡ç­¾
```

### ğŸ”— å¤–éƒ¨ M3U åˆå¹¶é…ç½®

æ”¯æŒä»å¤–éƒ¨ M3U æºä¸‹è½½å¹¶åˆå¹¶æŒ‡å®šåˆ†ç»„çš„é¢‘é“åˆ°ç”Ÿæˆçš„ M3U æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ç”¨äºè¡¥å……æœ¬åœ°é¢‘é“åˆ—è¡¨ä¸­æ²¡æœ‰çš„é¢‘é“ï¼ˆå¦‚ç²¤è¯­é¢‘é“ã€å†°èŒ¶ä½“è‚²ï¼‰ã€‚

```python
# å¤–éƒ¨ M3U åˆå¹¶é…ç½®
EXTERNAL_M3U_URL = "https://bc.188766.xyz/?ip=&mishitong=true&mima=mianfeibuhuaqian&json=true"  # å¤–éƒ¨ M3U ä¸‹è½½é“¾æ¥
EXTERNAL_GROUP_TITLES = ["ç²¤è¯­é¢‘é“"]  # è¦æå–çš„ group-title åˆ—è¡¨ï¼Œä¾‹å¦‚: ["å†°èŒ¶ä½“è‚²", "ç²¤è¯­é¢‘é“"]
ENABLE_EXTERNAL_M3U_MERGE = True  # æ˜¯å¦åˆå¹¶å¤–éƒ¨ M3U åˆ°æ‰€æœ‰ M3U æ–‡ä»¶ (True/False)
```

**é…ç½®è¯´æ˜**ï¼š
- **EXTERNAL_M3U_URL**ï¼šå¤–éƒ¨ M3U æ–‡ä»¶çš„ä¸‹è½½åœ°å€ï¼Œæ”¯æŒ HTTP/HTTPS åè®®
- **EXTERNAL_GROUP_TITLES**ï¼šè¦æå–çš„é¢‘é“åˆ†ç»„åˆ—è¡¨ï¼Œè„šæœ¬ä¼šä»å¤–éƒ¨ M3U ä¸­æå–è¿™äº› `group-title` çš„é¢‘é“
- **ENABLE_EXTERNAL_M3U_MERGE**ï¼šæ˜¯å¦å¯ç”¨å¤–éƒ¨ M3U åˆå¹¶åŠŸèƒ½ï¼Œè®¾ç½®ä¸º `False` å¯ç¦ç”¨æ­¤åŠŸèƒ½

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… è‡ªåŠ¨ä¸‹è½½å¤–éƒ¨ M3U æ–‡ä»¶ï¼ˆä½¿ç”¨æµè§ˆå™¨ User-Agent é¿å… 403 é”™è¯¯ï¼‰
- âœ… æŒ‰ `group-title` è¿‡æ»¤æå–æŒ‡å®šåˆ†ç»„çš„é¢‘é“
- âœ… è‡ªåŠ¨åº”ç”¨é»‘åå•è¿‡æ»¤è§„åˆ™
- âœ… æ”¯æŒ Nginx ä»£ç†ï¼ˆå¦‚æœè®¾ç½®äº† `NGINX_PROXY_PREFIX`ï¼Œå¤–éƒ¨é¢‘é“çš„ URL å’Œ Logo ä¼šè‡ªåŠ¨é€šè¿‡ä»£ç†ï¼‰
- âœ… æ™ºèƒ½æ’åºï¼šå¦‚æœå¤–éƒ¨åˆ†ç»„åœ¨ `GROUP_OUTPUT_ORDER` ä¸­ï¼Œä¼šæŒ‰é¡ºåºè¾“å‡ºï¼›å¦åˆ™ä¼šæ·»åŠ åˆ° M3U æ–‡ä»¶æœ«å°¾
- âœ… åˆå¹¶åˆ°æ‰€æœ‰ç”Ÿæˆçš„ M3U æ–‡ä»¶ï¼ˆtv.m3uã€tv2.m3uã€ku9.m3uï¼‰

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- å¦‚æœå¤–éƒ¨åˆ†ç»„åç§°åœ¨ `GROUP_OUTPUT_ORDER` ä¸­å·²å­˜åœ¨ï¼Œå¤–éƒ¨é¢‘é“ä¼šåˆå¹¶åˆ°å¯¹åº”åˆ†ç»„ä½ç½®
- å¦‚æœå¤–éƒ¨åˆ†ç»„åç§°ä¸åœ¨ `GROUP_OUTPUT_ORDER` ä¸­ï¼Œå¤–éƒ¨é¢‘é“ä¼šæ·»åŠ åˆ° M3U æ–‡ä»¶æœ«å°¾
- å¤–éƒ¨é¢‘é“åŒæ ·ä¼šåº”ç”¨é»‘åå•è¿‡æ»¤è§„åˆ™
- å¤–éƒ¨é¢‘é“çš„ Logo å’Œ URL ä¼šè‡ªåŠ¨åº”ç”¨ Nginx ä»£ç†ï¼ˆå¦‚æœå·²é…ç½®ï¼‰

### ğŸš« é»‘åå•é…ç½®

```python
BLACKLIST_RULES = {
    "title": ["æµ‹è¯•é¢‘é“", "è´­ç‰©", "å¯¼è§†", "ç™¾è§†é€š", "æŒ‡å—", "ç²¾é€‰é¢‘é“"],
    "code": [
        # æ·»åŠ è¦è¿‡æ»¤çš„é¢‘é“ä»£ç 
    ],
    "zteurl": [
        # æ·»åŠ è¦è¿‡æ»¤çš„æ’­æ”¾é“¾æ¥
    ]
}
```

## ğŸ“‹ é…ç½®æ–‡ä»¶

### custom_channels.json

è‡ªå®šä¹‰é¢‘é“é…ç½®æ–‡ä»¶ï¼Œæ ¼å¼ç¤ºä¾‹ï¼š

```json
{
    "å¹¿ä¸œåœ°æ–¹å°": [
            {
        "title": "éŸ¶å…³ç»¼åˆé«˜æ¸…",
        "code": "02000004000000052014120300000003",
        "ztecode": "",
        "icon": "http://183.235.16.92:8081/pics/micro-picture/channel/2020-11-04/e56deee4-990e-443d-8568-0f01953aed53.png",
        "zteurl": "rtp://239.11.0.84:1025",
        "supports_catchup": false,
        "quality": "é«˜æ¸…"
        }
    ]
}
```

**âš ï¸ æ³¨æ„**ï¼šå¦‚æœè‡ªå®šä¹‰äº†æ–°çš„åˆ†ç»„ï¼Œéœ€è¦åœ¨ `tv.py` çš„ `GROUP_DEFINITIONS` å’Œ `GROUP_OUTPUT_ORDER` ä¸­æ·»åŠ å¯¹åº”çš„åˆ†ç»„åç§°ã€‚

### channel_order.json

é¢‘é“æ’åºé…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆçš„m3uä¼šä¼˜å…ˆæŒ‰æ­¤åˆ—è¡¨è¿›è¡Œæ’åºï¼Œæ ¼å¼ç¤ºä¾‹ï¼š

```json
{
    "å¤®è§†": [
        "CCTV-1ç»¼åˆ",
        "CCTV-2è´¢ç»",
        "CCTV-3ç»¼è‰º"
    ],

    "å¹¿ä¸œ": [
        "å¹¿ä¸œç æ±Ÿé«˜æ¸…",
        "å¹¿ä¸œä½“è‚²é«˜æ¸…",
        "å¹¿ä¸œæ–°é—»é«˜æ¸…",
        "ä¸œèæ–°é—»ç»¼åˆé«˜æ¸…",
        "ä¸œèç”Ÿæ´»èµ„è®¯é«˜æ¸…",
        "å¹¿å·æ–°é—»é«˜æ¸…",
        "å¹¿å·ç»¼åˆé«˜æ¸…",
        "å¹¿ä¸œå«è§†é«˜æ¸…",
        "å¹¿ä¸œæ°‘ç”Ÿé«˜æ¸…",
        "ç»æµç§‘æ•™é«˜æ¸…",
        "å¤§æ¹¾åŒºå«è§†é«˜æ¸…"
    ]
}
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒè¦æ±‚

- ğŸ Python 3.x

### 2. è¿è¡Œè„šæœ¬

```bash
python tv.py
```

### 3. è¿è¡Œæ•ˆæœç¤ºä¾‹

```
ä½ çš„ç»„æ’­è½¬å•æ’­UDPXYåœ°å€æ˜¯ http://c.cc.top:7088/udp/
ä½ çš„å›çœ‹æºå‰ç¼€æ˜¯ http://183.235.162.80:6610/190000002005
ä½ çš„nginxä»£ç†å‰ç¼€æ˜¯ http://c.cc.top:7077/
ä½ çš„å›çœ‹URLæ¨¡æ¿æ˜¯ {prefix}/{ztecode}/index.m3u8?starttime=${{utc:yyyyMMddHHmmss}}&endtime=${{utcend:yyyyMMddHHmmss}}
ä½ çš„KU9å›çœ‹URLæ¨¡æ¿æ˜¯ {prefix}/{ztecode}/index.m3u8?starttime=${{(b)yyyyMMddHHmmss|UTC}}&endtime=${{(e)yyyyMMddHHmmss|UTC}}
EPGä¸‹è½½å¼€å…³: å¯ç”¨
EPGä¸‹è½½é…ç½®: é‡è¯•3æ¬¡, è¶…æ—¶15ç§’, é—´éš”2ç§’
æˆåŠŸåŠ è½½é¢‘é“æ’åºæ–‡ä»¶: channel_order.json
æˆåŠŸåŠ è½½è‡ªå®šä¹‰é¢‘é“æ–‡ä»¶: custom_channels.json
è‡ªå®šä¹‰é¢‘é“é…ç½®: ['å¹¿ä¸œ', 'å¹¿ä¸œåœ°æ–¹å°']
  åˆ†ç»„ 'å¹¿ä¸œ' æœ‰ 5 ä¸ªé¢‘é“
  åˆ†ç»„ 'å¹¿ä¸œåœ°æ–¹å°' æœ‰ 27 ä¸ªé¢‘é“
æˆåŠŸè·å– JSON æ•°æ®ä» http://183.235.16.92:8082/epg/api/custom/getAllChannel.json
å·²è¿‡æ»¤ 14 ä¸ªé»‘åå•é¢‘é“ï¼ˆä¸»JSONï¼‰
è‡ªå®šä¹‰é¢‘é“åç§°æ˜ å°„: 'å¹¿å·æ–°é—»-æµ‹è¯•' -> 'å¹¿å·æ–°é—»é«˜æ¸…'
è‡ªå®šä¹‰é¢‘é“åç§°æ˜ å°„: 'å¹¿å·ç»¼åˆ-æµ‹è¯•' -> 'å¹¿å·ç»¼åˆé«˜æ¸…'
å·²å°†å›çœ‹æºä»£ç†è‡³: http://c.cc.top:7077/183.235.162.80:6610/190000002005
å·²ä¸º 150 ä¸ªæ”¯æŒå›çœ‹çš„é¢‘é“æ·»åŠ catchupå±æ€§
å·²ç”ŸæˆM3Uæ–‡ä»¶: tv.m3u
å·²å°†å›çœ‹æºä»£ç†è‡³: http://c.cc.top:7077/183.235.162.80:6610/190000002005
å·²ä¸º 150 ä¸ªæ”¯æŒå›çœ‹çš„é¢‘é“æ·»åŠ catchupå±æ€§
å·²ç”ŸæˆM3Uæ–‡ä»¶: tv2.m3u
å·²å°†å›çœ‹æºä»£ç†è‡³: http://c.cc.top:7077/183.235.162.80:6610/190000002005
å·²ä¸º 150 ä¸ªæ”¯æŒå›çœ‹çš„é¢‘é“æ·»åŠ catchupå±æ€§
å·²ç”ŸæˆM3Uæ–‡ä»¶: ku9.m3u

å·²è·³è¿‡ 0 ä¸ªç¼ºå°‘æ’­æ”¾é“¾æ¥çš„é¢‘é“ã€‚
æ€»å…±è¿‡æ»¤ 14 ä¸ªé»‘åå•é¢‘é“ï¼ˆä¸»JSON: 14, è‡ªå®šä¹‰: 0ï¼‰
æˆåŠŸç”Ÿæˆ 191 ä¸ªé¢‘é“
å•æ’­åœ°å€åˆ—è¡¨: \\DS920\web\IPTV\cmcc_iptv_auto_py\tv2.m3u
KU9å›çœ‹å‚æ•°åˆ—è¡¨: \\DS920\web\IPTV\cmcc_iptv_auto_py\ku9.m3u
å·²ç”Ÿæˆå¤„ç†æ—¥å¿—: \\DS920\web\IPTV\cmcc_iptv_auto_py\channel_processing.log

å¼€å§‹ä¸‹è½½èŠ‚ç›®å•...
EPG æ¨¡å¼: M3U_ONLY (ä»…ä¸‹è½½å’Œåˆæˆ M3U ä¸­çš„é¢‘é“)
æ€»å…±å°†ä¸º 191 ä¸ª M3U é¢‘é“æ¡ç›®å°è¯•ä¸‹è½½EPGã€‚
XML æ–‡ä»¶å°†åŸºäºè¿™ 191 ä¸ªé¢‘é“ç”Ÿæˆã€‚
å‡†å¤‡å¹¶è¡Œä¸‹è½½ 191 ä¸ªé¢‘é“çš„EPGï¼Œä½¿ç”¨ 2 ä¸ªepgåœ°å€ä¸‹è½½...
  ä¸‹è½½è¿›åº¦: 191/191 ä¸ªé¢‘é“ (100.0%)
æ‰€æœ‰ä¸‹è½½ä»»åŠ¡å·²å®Œæˆã€‚
å·²ä¿å­˜èŠ‚ç›®å•XMLæ–‡ä»¶åˆ°: \\DS920\web\IPTV\cmcc_iptv_auto_py\t.xml
å·²ç”Ÿæˆå‹ç¼©æ–‡ä»¶: \\DS920\web\IPTV\cmcc_iptv_auto_py\t.xml.gz

==================================================
EPG åˆæˆç»Ÿè®¡
==================================================

åŸºæœ¬ç»Ÿè®¡:
   - XML ä¸­æ€»å…±å†™å…¥ 176 ä¸ªé¢‘é“
   - å…¶ä¸­ 176 ä¸ªé¢‘é“æˆåŠŸåˆæˆäº†èŠ‚ç›®æ•°æ®
   - æ€»å…±åˆæˆäº† 11731 ä¸ªèŠ‚ç›®æ¡ç›®
   - å·²è·³è¿‡ 15 ä¸ªæ²¡æœ‰èŠ‚ç›®æ•°æ®çš„é¢‘é“

è¯¦ç»†ç»Ÿè®¡å·²ä¿å­˜åˆ°: \\DS920\web\IPTV\cmcc_iptv_auto_py\epg_statistics.log
```

## ğŸ“¡ ç½‘ç»œç¯å¢ƒé…ç½®

### å‰ææ¡ä»¶

- **ğŸŒ å¹¿ä¸œç§»åŠ¨å®½å¸¦**ï¼šè„šæœ¬éœ€è¦è®¿é—® `183.235.0.0/16` ç½‘æ®µçš„IPTVæœåŠ¡å™¨
- **ğŸ”Œ IPTVæ¥å£**ï¼šéœ€è¦é…ç½®IPTVç½‘ç»œæ¥å£ï¼ˆå¦‚ `br-iptv`ï¼‰

### ç¯å¢ƒè¯´æ˜

**ğŸ’¡ æ¥¼ä¸»ç¯å¢ƒï¼šå¹¿ä¸œç§»åŠ¨å®½å¸¦**

- **ğŸ“¶ è·¯ç”±å™¨**ï¼šimmortalwrt 23.05ï¼Œå•çº¿å¤ç”¨ï¼Œå…‰çŒ«åˆ°å®¢å…åªè¦ä¸€æ¡çº¿

![å•çº¿å¤ç”¨é…ç½®](files/20251107165649301.webp)

- **ğŸ”§ å…‰çŒ«é…ç½®**ï¼šå…‰çŒ«æ”¹æ¡¥æ¥åï¼Œåªä¿®æ”¹interneté‚£è¾¹çš„vlanï¼Œå°±æ˜¯åˆ’åˆ†internet vlanåˆ°å•çº¿å¤ç”¨çº¿æ¥å£ï¼Œç”¨æˆ·ä¾§è‡ªå®šä¹‰ï¼Œè®¾ä¸º3ï¼Œiptvä¸åˆ’vlanï¼Œå•çº¿å¤ç”¨å£ç›´å‡ºï¼ˆå› ä¸ºæµ‹è¯•è¿‡iptvåˆ’vlanå¯¼è‡´4åˆ†é’Ÿå¡é¡¿ï¼‰
- **âš™ï¸ è·¯ç”±å™¨é…ç½®**ï¼šwanå£ä¸Šç½‘ç”¨vlanå°±æ˜¯eth1.3ï¼Œæ–°å»ºiptvå£ä¸ç”¨vlanï¼Œè®¾ç½®å°±æ˜¯eth1ï¼Œiptvå£ä¸ºbr-iptv(dhcpæ¨¡å¼)ï¼Œæœºé¡¶ç›’æ¡¥æ¥br-iptvç½‘ç»œå¯ä»¥æ­£å¸¸è§‚çœ‹
- **ğŸ” é‰´æƒè®¾ç½®**ï¼šç”±äºå®æµ‹ç§»åŠ¨iptvä¸é‰´æƒï¼Œæ‰€ä»¥æ²¡æœ‰é’ˆå¯¹è®¾ç½®hostnameã€macåœ°å€ã€Vendor class identifierè®¾ç½®
  - âš ï¸ å¦‚æœè®¾ç½®äº†æœºé¡¶ç›’macç­‰ï¼Œå¯¼è‡´æœºé¡¶ç›’ä¸å¯ç”¨äº†

### ğŸ” æŠ“åŒ…è·å–é¢‘é“æ•°æ®ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦æ‰‹åŠ¨è·å–é¢‘é“æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š

#### 1. ğŸ“¦ ä½¿ç”¨tcpdumpæŠ“åŒ…

```bash
# immortalwrt å®‰è£…tcpdump
tcpdump -i br-iptv -w /tmp/iptv_capture.pcap

# æ‰“å¼€ç›’å­ç”µæºï¼Œç­‰å¾…å¯åŠ¨å®Œæˆåæ‰“å¼€ç›´æ’­éšä¾¿åˆ‡å‡ ä¸ªå°ã€‚å›çœ‹ä¸€ä¸‹,ç„¶åç»“æŸ
```

#### 2. ğŸ” ä½¿ç”¨Wiresharkåˆ†æ

å°†æŠ“åŒ…æ–‡ä»¶æå–åˆ°Windowsï¼Œç”¨Wiresharkåˆ†æï¼š

![Wiresharkåˆ†æ](files/pixpin_2025-10-15_20-54-37.png)

æŒ‰å¤§å°æ’åºå¾—åˆ°200kå·¦å³çš„getChannelçš„jsonæ–‡ä»¶ï¼š

![æŒ‰å¤§å°æ’åº](files/pixpin_2025-10-15_20-55-19.png)

æŒ‰å¤§å°æ’åºæœ€å¤§çš„æ˜¯å›çœ‹æµé‡ï¼Œæˆ‘çš„æ˜¯ä¸­å…´æ ¼å¼ï¼Œåä¸ºå›çœ‹æµé‡æš‚æœªå®ç°ï¼Œä½†åä¸ºç”¨æˆ·ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸­å…´æ ¼å¼

![](https://r2.bennq.top/piclist/20251119121036543.webp)

ç‚¹å‡» 10 MB æ•°æ®ï¼Œå…³é—­çª—å£ï¼Œè¿½è¸ª HTTP æµã€‚

![è¿½ç»ˆhttpæµ](files/PixPin_2025-11-20_14-20-33.webp)

æ‹¼æ¥å›çœ‹åœ°å€ã€‚

![å¹¶æ¥åœ°å€](files/PixPin_2025-11-20_14-22-10.webp)

æ‹¼æ¥ GET Host å¤´å¾—å‡ºå›çœ‹çš„å®é™…åœ°å€ï¼Œå¯ä»¥ç›´æ¥åœ¨ MPV æˆ–è€… PotPlayer æ’­æ”¾ï¼š
`http://183.235.162.80:6610//190000002005/ch000000000000328/index.m3u8?AuthInfo=xxx&version=xxx&starttime=20251015T220000.00Z&endtime=20251016T000000.00Z&IASHttpSessionId=RR14723020251016084714108007&ispcode=7`

ç®€åŒ–åæ’­æ”¾æ­£å¸¸ï¼š

`http://183.235.162.80:6610//190000002005/ch000000000000328/index.m3u8?starttime=20251015T220000.00Z&endtime=20251016T000000.00Z`

å¾—å‡ºå›çœ‹æºå‰ç¼€ï¼š`http://183.235.162.80:6610//190000002005`

#### 3. ğŸ“¡ åˆ†æå¾—åˆ°çš„ API åœ°å€

åˆ†ææŠ“åŒ…æ•°æ®å¯ä»¥å¾—åˆ°ä»¥ä¸‹å¯è®¿é—®åœ°å€ï¼š

```
http://183.235.11.39:8082/epg/api/custom/getChannelsInCategory.json?code=category_54543193 
http://183.235.11.39:8082/epg/api/custom/getAllChannel.json  æ²¡æœ‰æ™´å½©  çœ‹æ¥æœåŠ¡åœ°å€ä¸åŒè¿”å›ä¸åŒçš„é¢‘é“

http://183.235.16.92:8082/epg/api/custom/getAllChannel.json    è¿™ä¸ªåœ°å€ä¹Ÿè¡Œ,è€Œä¸”æ˜¯æ ‡å‡†çš„jsonæ ¼å¼  å¤šäº†æ™´å½©é¢‘é“
http://183.235.16.92:8082/epg/api/custom/getAllChannel2.json 
```

**âš ï¸ æ³¨æ„**ï¼š**é»˜è®¤ç½‘ç»œæ˜¯æ— æ³•è®¿é—® `183.235.0.0/16` çš„æµé‡ï¼Œå¿…é¡»é€šè¿‡iptvç«¯å£ã€‚ç½‘ä¸Šæœ‰æ‰‹åŠ¨æ·»åŠ é™æ€è·¯ç”±çš„åŠæ³•ï¼Œä½†æ˜¯å®æµ‹dhcpè·å¾—çš„ipä¼šå˜åŠ¨ï¼Œæœ‰æ—¶æ˜¯100.93.0.Xï¼Œæœ‰æ—¶æ˜¯10.150.0.xï¼Œæœ‰æ—¶æ˜¯100.125.71.xã€‚**

### ğŸ›£ï¸ è‡ªåŠ¨è·¯ç”±é…ç½®

ç”±äºé»˜è®¤ç½‘ç»œæ— æ³•è®¿é—® `183.235.0.0/16` æµé‡ï¼Œéœ€è¦é…ç½®è·¯ç”±ã€‚è„šæœ¬æä¾›äº†è‡ªåŠ¨è·¯ç”±é…ç½®æ–¹æ¡ˆï¼š

- ğŸ”„ æ ¹æ® br-iptv æ¥å£çš„ DHCP ç½‘å…³è‡ªåŠ¨æ›´æ–°é™æ€è·¯ç”±
- ğŸ›£ï¸ å°†br-iptv æ¥å£è·å–åˆ°çš„dhcp ipæœ€åä¸€ä½æ”¹ä¸º1ååŠ å…¥åˆ°è·¯ç”±ç½‘å…³ï¼Œ183.235.0.0/16 æµé‡ä¼šç»è¿‡æ–°è®¾ç½®çš„ç½‘å…³å‡ºå£ï¼Œä»è€Œå®ç°è‡ªåŠ¨æ›´æ–°è®¿é—®183æµé‡
- âš ï¸ **æ³¨æ„ï¼Œbr-iptv æ¥å£ä¸ºdhcpæ¨¡å¼**ï¼Œé˜²ç«å¢™å‚è€ƒä¸‹é¢è®¾ç½®

#### 1. ğŸ“ åˆ›å»ºè·¯ç”±æ›´æ–°è„šæœ¬

```bash
cat > /usr/bin/update-iptv-route << 'EOF'
#!/bin/sh

IP=$(ip addr show br-iptv 2>/dev/null | grep -o 'inet [0-9.]*/' | cut -d' ' -f2 | cut -d'/' -f1)

[ -z "$IP" ] && exit 1

CURRENT_GW=$(echo "$IP" | awk -F. '{print $1"."$2"."$3".1"}')

ip route del 183.235.0.0/16 2>/dev/null
ip route add 183.235.0.0/16 via "$CURRENT_GW" dev br-iptv
EOF

chmod +x /usr/bin/update-iptv-route
```

#### 2. ğŸ”Œ åˆ›å»ºç½‘ç»œæ¥å£çƒ­æ’æ‹”è„šæœ¬

```bash
cat > /etc/hotplug.d/iface/99-iptv-route << 'EOF'
#!/bin/sh

[ "$ACTION" = "ifup" ] && [ "$INTERFACE" = "iptv" ] || exit 0

echo "IPTV æ¥å£å·²å¯åŠ¨ï¼Œç­‰å¾…ç½‘ç»œå°±ç»ª..."
sleep 10
/usr/bin/update-iptv-route
EOF

chmod +x /etc/hotplug.d/iface/99-iptv-route
```

#### 3. âš™ï¸ é…ç½®ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ

```bash
# æ·»åŠ åˆ° rc.local ç¡®ä¿å¯åŠ¨æ—¶è¿è¡Œ
echo "sleep 25 && /usr/bin/update-iptv-route" >> /etc/rc.local
```

#### 4. âœ… éªŒè¯è·¯ç”±é…ç½®

```bash
# æ‰‹åŠ¨æµ‹è¯•è·¯ç”±è„šæœ¬
/usr/bin/update-iptv-route

# æ£€æŸ¥è·¯ç”±æ˜¯å¦æ·»åŠ 
ip route | grep 183.235
```

### ğŸ”¥ é˜²ç«å¢™é…ç½®

éœ€è¦åœ¨é˜²ç«å¢™ä¸­é…ç½®LANåˆ°IPTVçš„è½¬å‘è§„åˆ™ï¼Œå…è®¸è®¿é—®IPTVç½‘ç»œã€‚

![é˜²ç«å¢™é…ç½®](files/pixpin_2025-11-05_22-39-00.webp)

## ğŸ§ª åˆæ­¥æµ‹è¯•

### ğŸŒ å®ç°æµè§ˆå™¨è®¿é—®

æµ‹è¯•JSONæ•°æ®æºæ˜¯å¦å¯è®¿é—®ï¼š
- [http://183.235.16.92:8082/epg/api/custom/getAllChannel.json](http://183.235.16.92:8082/epg/api/custom/getAllChannel.json)

### âª å®ç°å›çœ‹æµ‹è¯•

å®ç° potplayer æˆ–è€… mpv å›çœ‹ï¼Œstarttime/endtime ä¿®æ”¹ä¸ºæ˜¨å¤©é—´éš” 5 å°æ—¶å†…çš„å‚æ•°ï¼š

```
http://183.235.162.80:6610/190000002005/ch000000000000329/index.m3u8?starttime=20251118100000&endtime=20251118112000
```



## ğŸŒ Nginxä»£ç†é…ç½®ï¼ˆå¤–ç½‘è®¿é—®ï¼‰

- ğŸŒ å¦‚æœéœ€è¦é€šè¿‡å¤–ç½‘è®¿é—®å›çœ‹åŠŸèƒ½ï¼Œéœ€è¦é…ç½®Nginxä»£ç†ã€‚é»˜è®¤ä¸ºç©ºï¼Œæƒ³å®ç°å±€åŸŸç½‘è§‚çœ‹å†è€ƒè™‘å›æ¥è®¾ç½®
- ğŸ“ è¦æ±‚è‡ªæœ‰åŸŸåã€DDNS

### 1. ğŸ“¦ å®‰è£…Nginx

```bash
opkg update
opkg install nginx
```

### 2. âš™ï¸ ç¦ç”¨UCIç®¡ç†

- âš ï¸ ç”±äºopenwrté»˜è®¤ä½¿ç”¨ucié…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤æˆ–è€…ç¦ç”¨
  - ä¿®æ”¹ `/etc/config/nginx`ï¼Œå°† `uci_enable` è®¾ç½®ä¸º `false`ï¼Œæˆ–åˆ é™¤UCIé…ç½®ä¸­çš„serverå—ã€‚

### 3. ğŸ”§ é…ç½®Nginxä»£ç†

åˆ›å»ºä»£ç†é…ç½®æ–‡ä»¶ï¼š
- è§£æå™¨è®¾ç½®ä¸ºè‡ªå·±çš„ OpenWrt IPï¼Œä¹Ÿå°±æ˜¯ DNSï¼Œå¯è®¾ä¸º 223.5.5.5ã€‚

```bash
cat > /etc/nginx/conf.d/nginx-proxy.conf << 'EOF'
server {
    listen 7077;
    listen [::]:7077;
    
    # è§£æå™¨è®¾ç½®
    resolver 10.10.10.1;
    
    # é€šç”¨ä»£ç† - æ”¯æŒä»»æ„ç›®æ ‡åœ°å€
    location ~* "^/(?<target_host>[^/]+)(?<target_path>.*)$" {
        # æ„å»ºä»£ç†ç›®æ ‡URL
        set $proxy_target "http://$target_host$target_path$is_args$args";
        
        proxy_pass $proxy_target;
        proxy_set_header Host $target_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        proxy_connect_timeout 30s;
        proxy_send_timeout 600s;
        proxy_read_timeout 600s;
        proxy_buffering off;
    }
}
EOF
```

### 4. ğŸ“ é…ç½®ä¸»é…ç½®æ–‡ä»¶

```bash
cat > /etc/nginx/nginx.conf << 'EOF'
user root;
worker_processes 1;

error_log /var/log/nginx/error.log;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    access_log off;

    sendfile on;
    keepalive_timeout 65;

    include /etc/nginx/conf.d/*.conf;
}
EOF
```

### 5. âœ… æ£€æŸ¥å’Œç®¡ç†Nginx

```bash
# æ£€æŸ¥é…ç½®æ˜¯å¦æœ‰æ•ˆ
nginx -t

# æ£€æŸ¥è¿›ç¨‹å’Œç«¯å£
ps | grep nginx
netstat -ln | grep 7077

# é‡è½½Nginx
/etc/init.d/nginx reload
/etc/init.d/nginx restart
```

é…ç½®å®Œæˆåï¼Œtv.pyæ–‡ä»¶ä¿®æ”¹ `NGINX_PROXY_PREFIX = "http://c.top:7077"`ï¼Œå›çœ‹åœ°å€å’ŒLogoåœ°å€ä¼šè‡ªåŠ¨é€šè¿‡Nginxä»£ç†ï¼š

- âª å›çœ‹åœ°å€ï¼š`http://c.top:7077/183.235.162.80:6610/190000002005/ch000000000000104/index.m3u8?starttime=...`
- ğŸ–¼ï¸ Logoåœ°å€ï¼š`http://c.top:7077/183.235.16.92:8081/pics/micro-picture/channelNew/xxx.png`

## â° å®šæ—¶ä»»åŠ¡

å»ºè®®å°†è„šæœ¬æ·»åŠ åˆ°å®šæ—¶ä»»åŠ¡ä¸­ï¼Œå®šæœŸæ›´æ–°é¢‘é“åˆ—è¡¨å’ŒEPGã€‚

### ğŸ–¥ï¸ ç¾¤æ™–NAS

åœ¨ç¾¤æ™–çš„"ä»»åŠ¡è®¡åˆ’å™¨"ä¸­æ·»åŠ å®šæ—¶ä»»åŠ¡ã€‚

### ğŸ§ Linux/OpenWrt

ä½¿ç”¨crontabï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹è¿è¡Œï¼‰
0 2 * * * cd /path/to/script && /usr/bin/python3 tv.py
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ğŸ“Š é¢‘é“åˆ†ç»„é€»è¾‘

è„šæœ¬æŒ‰ç…§ä»¥ä¸‹ä¼˜å…ˆçº§å¯¹é¢‘é“è¿›è¡Œåˆ†ç±»ï¼š

1. ğŸ¬ å°‘å„¿ï¼ˆå¿…é¡»åœ¨å¤®è§†ä¹‹å‰,é¿å…CCTVå°‘å„¿è¢«åˆ†åˆ°å¤®è§†ç»„ï¼‰
2. ğŸ¥ è¶…æ¸…4kï¼ˆå¿…é¡»åœ¨å¤®è§†ä¹‹å‰ï¼‰
3. ğŸ“º å¤®è§†
4. â­ å¤®è§†ç‰¹è‰²
5. ğŸ  å¹¿ä¸œ
6. ğŸŒ CGTN
7. ğŸ“¡ å«è§†
8. ğŸ® åæ•°å’ªå’•
9. ğŸ“‹ å…¶ä»–
10. ğŸ˜ï¸ å¹¿ä¸œåœ°æ–¹å°

### ğŸ“º EPGä¸‹è½½æœºåˆ¶

- ğŸŒ æ”¯æŒå¤šæºå¹¶è¡Œä¸‹è½½ï¼Œè‡ªåŠ¨åˆ†é…ä»»åŠ¡
- ğŸ“… è‡ªåŠ¨ä¸‹è½½å½“å¤©å’Œæ¬¡æ—¥çš„EPGæ•°æ®
- ğŸ”„ æ”¯æŒé‡è¯•æœºåˆ¶ï¼ˆé»˜è®¤é‡è¯•3æ¬¡ï¼‰
- ğŸ“Š æ˜¾ç¤ºå®æ—¶ä¸‹è½½è¿›åº¦

### âª å›çœ‹URLæ ¼å¼

- **æ ‡å‡†æ ¼å¼**ï¼š`{prefix}/{ztecode}/index.m3u8?starttime=${{utc:yyyyMMddHHmmss}}&endtime=${{utcend:yyyyMMddHHmmss}}`
- **KU9æ ¼å¼**ï¼š`{prefix}/{ztecode}/index.m3u8?starttime=${{(b)yyyyMMddHHmmss|UTC}}&endtime=${{(e)yyyyMMddHHmmss|UTC}}`

## ğŸ“š å‚è€ƒèµ„æº

- ğŸ“– [IPTVç›¸å…³æ•™ç¨‹](https://www.hyun.tech/archives/iptv)
- ğŸ”— [gmcc-iptvé¡¹ç›®](https://github.com/pcg562240/gmcc-iptv)
- ğŸ› ï¸ [iptv-toolå·¥å…·](https://github.com/taksssss/iptv-tool) - ä¸ºæ²¡æœ‰EPGçš„é¢‘é“æä¾›é¢å¤–æ”¯æŒ
- ğŸ’¬ [æ©å±±åŸå¸–](https://www.right.com.cn/forum/thread-8453808-1-1.html)

## ğŸ“Š æ•ˆæœå±•ç¤º

### ä½¿ç”¨æ•ˆæœ

- **ğŸŒ åŒåŸç§»åŠ¨å¤§å±€åŸŸç½‘è®¿é—®æ­£å¸¸**ï¼šå¤šå¥—æˆ¿å­å®ç°å…±äº«ï¼Œé‰´äºä¸Šä¼ å¸¦å®½40mbpsï¼Œæ­£å¸¸åªæ”¯æŒå¤–ç½‘4è·¯8mç ç‡çš„
- **ğŸ“º EPGæ•°æ®å®Œæ•´**ï¼šå¤§éƒ¨åˆ†é¢‘é“æœ‰æ˜å¤©çš„epgï¼Œç½‘ä¸Šçš„åŸºæœ¬éƒ½æ˜¯å½“å¤©çš„ï¼Œå›çœ‹æ­£å¸¸ï¼Œåªé’ˆå¯¹é…·9æœ€æ–°ç‰ˆæœ¬
- **ğŸ˜ï¸ æœ¬åœ°å°æ”¯æŒ**ï¼šç¼ºå¤±å¤§éƒ¨åˆ†å¹¿ä¸œæœ¬åœ°å°çš„ztecodeã€codeï¼Œå› ä¸ºé»˜è®¤jsonéƒ½ä¸å¸¦æœ¬åœ°å°ï¼Œéœ€è¦é€šè¿‡ `custom_channels.json` æ‰‹åŠ¨æ·»åŠ 

### æ’­æ”¾å™¨æ•ˆæœæˆªå›¾

![æ•ˆæœå±•ç¤º1](files/pixpin_2025-11-03_18-36-13.webp)

![æ•ˆæœå±•ç¤º2](files/pixpin_2025-11-03_18-36-23.webp)

![æ•ˆæœå±•ç¤º3](files/pixpin_2025-11-03_18-36-30.webp)

![æ•ˆæœå±•ç¤º4](files/pixpin_2025-11-03_18-36-43.webp)

![æ•ˆæœå±•ç¤º5](files/pixpin_2025-11-03_18-37-01.webp)

![æ•ˆæœå±•ç¤º6](files/pixpin_2025-11-03_18-39-11.webp)

![æ•ˆæœå±•ç¤º7](files/pixpin_2025-11-03_18-39-40.webp)

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ğŸŒ ç½‘ç»œè®¿é—®**ï¼šè„šæœ¬éœ€è¦èƒ½å¤Ÿè®¿é—® `183.235.0.0/16` ç½‘æ®µï¼Œå¿…é¡»é€šè¿‡IPTVæ¥å£
2. **ğŸ“‹ é¢‘é“æ•°æ®**ï¼šé»˜è®¤JSONå¯èƒ½ä¸åŒ…å«æ‰€æœ‰æœ¬åœ°å°ï¼Œéœ€è¦é€šè¿‡ `custom_channels.json` æ‰‹åŠ¨æ·»åŠ 
3. **â° å›çœ‹æ—¶é—´**ï¼šå›çœ‹ä½¿ç”¨UTCæ—¶é—´
4. **ğŸ“º EPGæ•°æ®**ï¼šå¤§éƒ¨åˆ†é¢‘é“æœ‰æ¬¡æ—¥çš„EPGæ•°æ®ï¼Œæ¯”ç½‘ä¸Šå¸¸è§çš„EPGæºæ›´å®Œæ•´
5. **âª é¢å¤–ä¸»json**ï¼š[http://183.235.16.92:8082/epg/api/getAllChannel.json](http://183.235.16.92:8082/epg/api/getAllChannel.json) è¿™ä¸ªåœ°å€åŒ…å«å¤§é‡åœ°æ–¹å°ï¼Œä½†æ˜¯è¿‘100ä¸ªå¤±æ•ˆï¼Œæš‚æ—¶ä¸é‡‡ç”¨ï¼Œå¯ä»¥ä½œä¸ºè‡ªå®šä¹‰å‚è€ƒ

## ğŸ› é—®é¢˜åé¦ˆ

å¦‚æœè„šæœ¬è¿è¡Œå‡ºç°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. ğŸ“ æŸ¥çœ‹ `channel_processing.log` äº†è§£é¢‘é“å¤„ç†è¯¦æƒ…
2. ğŸ“Š æŸ¥çœ‹ `epg_statistics.log` äº†è§£EPGä¸‹è½½æƒ…å†µ
3. ğŸ” æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œè·¯ç”±é…ç½®
4. ğŸ¤– ä½¿ç”¨AIå·¥å…·åˆ†æé”™è¯¯ä¿¡æ¯

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚
